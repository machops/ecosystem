# GitHub Actions Policy Configuration
# URI: eco-base://policy/github-actions
# Schema: v1

policy:
  # Require all actions to be from approved organizations
  require_org_ownership: false
  
  # List of allowed organizations
  allowed_organizations:
    - indestructibleorg
    - actions
    - google-github-actions
    - azure
    - docker
    - github
    - codacy
    - aquasecurity
    - trufflesecurity
    - sigstore

  # Require all actions to be pinned to full-length commit SHAs
  require_sha_pinning: false
  
  # Block tag references (e.g., @v1, @v2, @main)
  block_tag_references: false
  
  # Require Docker actions to be pinned to SHA256 digests
  require_docker_digest_pinning: false
  
  # Enforcement level: error | warning
  enforcement_level: warning

# Explicitly blocked actions (highest priority)
blocked_actions: []

# Approved GitHub-owned actions (exempt from org ownership check)
approved_actions:
  # Core GitHub Actions
  - actions/checkout
  - actions/upload-artifact
  - actions/download-artifact
  - actions/setup-python
  - actions/setup-node
  - actions/setup-go
  - actions/setup-java
  - actions/cache
  - actions/github-script
  - actions/labeler
  - actions/stale
  - actions/create-github-app-token
  - actions/attest-build-provenance
  - actions/upload-pages-artifact
  - actions/deploy-pages

  # GitHub CodeQL Actions
  - github/codeql-action/init
  - github/codeql-action/analyze
  - github/codeql-action/upload-sarif
  - github/codeql-action/autobuild

  # Google GitHub Actions (explicitly approved)
  - google-github-actions/auth
  - google-github-actions/get-gke-credentials
  - google-github-actions/setup-gcloud

  # Security Scanning Actions
  - codacy/codacy-analysis-cli-action
  - codacy/codacy-coverage-reporter-action
  - aquasecurity/trivy-action
  - trufflesecurity/trufflehog

  # Supply Chain Security
  - sigstore/cosign-installer