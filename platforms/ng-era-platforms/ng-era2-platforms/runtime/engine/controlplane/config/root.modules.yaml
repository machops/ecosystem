---
apiVersion: machinenativeops.io/v1
kind: RootModulesConfig
metadata:
  annotations:
    machinenativeops.io/description: Root layer modules registration and dependency
      management
    machinenativeops.io/last-modified: '2025-12-20T22:00:00Z'
  labels:
    eco-base/governance: aligned
    eco-base/part-of: eco-base
    machinenativeops.io/app.kubernetes.io/component: modules-registry
    machinenativeops.io/tier: modules
    machinenativeops.io/version: v1.0.0
  name: modules-registry-config
  namespace: machinenativenops-modules
spec:
  dependency_graph:
    config-manager: []
    crypto-provider:
    - config-manager
    database-connector:
    - config-manager
    governance-engine:
    - config-manager
    - logging-service
    - database-connector
    hash-calculator:
    - config-manager
    integrity-validator:
    - config-manager
    - hash-calculator
    - notification-service
    logging-service:
    - config-manager
    machinenativenops-auto-monitor:
    - config-manager
    - logging-service
    - database-connector
    notification-service:
    - config-manager
    provenance-tracker:
    - config-manager
    - database-connector
    - hash-calculator
    storage-backend:
    - config-manager
    super-execution-engine:
    - config-manager
    - workflow-engine
    - task-queue
    - governance-engine
    task-queue:
    - config-manager
    - database-connector
    trust-manager:
    - config-manager
    - crypto-provider
    - storage-backend
    workflow-engine:
    - config-manager
    - task-queue
  groups:
  - auto_start: true
    criticality: critical
    description: Core system modules required for basic functionality
    fail_fast: true
    name: core
    priority: 100
  - auto_start: true
    criticality: critical
    description: Security and trust related modules
    fail_fast: true
    name: security
    priority: 90
  - auto_start: true
    criticality: high
    description: Execution and workflow orchestration modules
    fail_fast: false
    name: execution
    priority: 70
  - auto_start: true
    criticality: medium
    description: Monitoring and alerting modules
    fail_fast: false
    name: monitoring
    priority: 60
  - auto_start: false
    criticality: low
    description: Utility and helper modules
    fail_fast: false
    name: utility
    priority: 50
  lifecycle_management:
    installation:
    - pre_install_validation: true
    - dependency_check: true
    - resource_allocation: true
    - health_check: true
    shutdown:
    - graceful_shutdown_timeout: 60s
    - dependency_order_reverse: true
    - force_shutdown_after_timeout: true
    startup:
    - dependency_order_enforcement: true
    - health_check_timeout: 300s
    - failure_retry_attempts: 3
    - startup_failure_action: stop_dependent_modules
    update:
    - rolling_update_enabled: true
    - update_strategy: recreate
    - max_unavailable: 25%
    - health_check_after_update: true
  load_sequence:
  - description: Configuration manager must load first
    modules:
    - config-manager
    stage: 0
  - description: Core infrastructure services
    modules:
    - logging-service
    - crypto-provider
    - storage-backend
    - database-connector
    - hash-calculator
    stage: 1
  - description: Supporting services
    modules:
    - notification-service
    - workflow-engine
    - task-queue
    - machinenativenops-auto-monitor
    stage: 2
  - description: Security and governance services
    modules:
    - governance-engine
    - trust-manager
    stage: 3
  - description: Audit and integrity services
    modules:
    - provenance-tracker
    - integrity-validator
    stage: 4
  - description: Execution engine loads last
    modules:
    - super-execution-engine
    stage: 5
  modules:
  - auto_start: true
    dependencies:
    - name: config-manager
      optional: false
      version: '>=1.0.0'
    - name: logging-service
      optional: false
      version: '>=1.0.0'
    - name: database-connector
      optional: false
      version: '>=1.0.0'
    description: Core governance and policy enforcement engine
    enabled: true
    entrypoint: /opt/machinenativenops/modules/governance-engine/main.py
    environment:
    - name: GOVERNANCE_MODE
      value: enforce
    - name: POLICY_REFRESH_INTERVAL
      value: '300'
    - name: AUDIT_RETENTION_DAYS
      value: '2555'
    group: core
    health_check:
      endpoint: /health
      interval: 30s
      retries: 3
      timeout: 10s
    name: governance-engine
    priority: 100
    resources:
      cpu:
        limit: 1000m
        request: 200m
      memory:
        limit: 1Gi
        request: 256Mi
      storage:
        limit: 500Mi
        request: 100Mi
    version: 1.0.0
  - auto_start: true
    dependencies:
    - name: config-manager
      optional: false
      version: '>=1.0.0'
    - name: crypto-provider
      optional: false
      version: '>=1.0.0'
    - name: storage-backend
      optional: false
      version: '>=1.0.0'
    description: Trust chain and certificate management system
    enabled: true
    entrypoint: /opt/machinenativenops/modules/trust-manager/main.py
    environment:
    - name: CERT_ROTATION_PERIOD
      value: '7776000'
    - name: TRUST_STORE_PATH
      value: /etc/machinenativenops/trust
    - name: KEY_ALGORITHM
      value: RSA-4096
    group: security
    health_check:
      endpoint: /health
      interval: 30s
      retries: 3
      timeout: 10s
    name: trust-manager
    priority: 90
    resources:
      cpu:
        limit: 500m
        request: 100m
      memory:
        limit: 512Mi
        request: 128Mi
      storage:
        limit: 2Gi
        request: 500Mi
    version: 1.0.0
  - auto_start: true
    dependencies:
    - name: config-manager
      optional: false
      version: '>=1.0.0'
    - name: database-connector
      optional: false
      version: '>=1.0.0'
    - name: hash-calculator
      optional: false
      version: '>=1.0.0'
    description: Provenance and audit trail tracking system
    enabled: true
    entrypoint: /opt/machinenativenops/modules/provenance-tracker/main.py
    environment:
    - name: PROVENANCE_RETENTION_YEARS
      value: '7'
    - name: HASH_ALGORITHM
      value: SHA-256
    - name: COMPRESSION_ENABLED
      value: 'true'
    group: security
    health_check:
      endpoint: /health
      interval: 60s
      retries: 3
      timeout: 15s
    name: provenance-tracker
    priority: 85
    resources:
      cpu:
        limit: 800m
        request: 150m
      memory:
        limit: 2Gi
        request: 512Mi
      storage:
        limit: 10Gi
        request: 1Gi
    version: 1.0.0
  - auto_start: true
    dependencies:
    - name: config-manager
      optional: false
      version: '>=1.0.0'
    - name: hash-calculator
      optional: false
      version: '>=1.0.0'
    - name: notification-service
      optional: true
      version: '>=1.0.0'
    description: System integrity validation and drift detection
    enabled: true
    entrypoint: /opt/machinenativenops/modules/integrity-validator/main.py
    environment:
    - name: VALIDATION_INTERVAL
      value: '3600'
    - name: DRIFT_THRESHOLD
      value: '0.01'
    - name: AUTO_REPAIR_ENABLED
      value: 'false'
    group: security
    health_check:
      endpoint: /health
      interval: 300s
      retries: 3
      timeout: 30s
    name: integrity-validator
    priority: 80
    resources:
      cpu:
        limit: 400m
        request: 100m
      memory:
        limit: 1Gi
        request: 256Mi
      storage:
        limit: 1Gi
        request: 100Mi
    version: 1.0.0
  - auto_start: true
    dependencies:
    - name: config-manager
      optional: false
      version: '>=1.0.0'
    - name: workflow-engine
      optional: false
      version: '>=1.0.0'
    - name: task-queue
      optional: false
      version: '>=1.0.0'
    - name: governance-engine
      optional: false
      version: '>=1.0.0'
    description: Cross-system execution and workflow orchestration
    enabled: true
    entrypoint: /opt/machinenativenops/modules/super-execution-engine/main.py
    environment:
    - name: MAX_CONCURRENT_WORKFLOWS
      value: '50'
    - name: WORKFLOW_TIMEOUT
      value: '3600'
    - name: RETRY_ATTEMPTS
      value: '3'
    group: execution
    health_check:
      endpoint: /health
      interval: 30s
      retries: 3
      timeout: 15s
    name: super-execution-engine
    priority: 70
    resources:
      cpu:
        limit: 2000m
        request: 300m
      memory:
        limit: 2Gi
        request: 512Mi
      storage:
        limit: 1Gi
        request: 200Mi
    version: 1.0.0
  - auto_start: true
    dependencies: []
    description: Centralized configuration management
    enabled: true
    entrypoint: /opt/machinenativenops/modules/config-manager/main.py
    environment:
    - name: CONFIG_CACHE_TTL
      value: '300'
    - name: CONFIG_WATCH_ENABLED
      value: 'true'
    - name: SCHEMA_VALIDATION_ENABLED
      value: 'true'
    group: core
    health_check:
      endpoint: /health
      interval: 30s
      retries: 3
      timeout: 10s
    name: config-manager
    priority: 110
    resources:
      cpu:
        limit: 200m
        request: 50m
      memory:
        limit: 256Mi
        request: 64Mi
      storage:
        limit: 200Mi
        request: 50Mi
    version: 1.0.0
  - auto_start: true
    dependencies:
    - name: config-manager
      optional: false
      version: '>=1.0.0'
    description: Centralized logging and log management
    enabled: true
    entrypoint: /opt/machinenativenops/modules/logging-service/main.py
    environment:
    - name: LOG_ROTATION_INTERVAL
      value: '86400'
    - name: LOG_COMPRESSION_ENABLED
      value: 'true'
    - name: LOG_RETENTION_DAYS
      value: '30'
    group: core
    health_check:
      endpoint: /health
      interval: 30s
      retries: 3
      timeout: 10s
    name: logging-service
    priority: 105
    resources:
      cpu:
        limit: 500m
        request: 100m
      memory:
        limit: 512Mi
        request: 128Mi
      storage:
        limit: 5Gi
        request: 1Gi
    version: 1.0.0
  - auto_start: true
    dependencies:
    - name: config-manager
      optional: false
      version: '>=1.0.0'
    - name: logging-service
      optional: false
      version: '>=1.0.0'
    description: System monitoring and metrics collection service
    enabled: true
    entrypoint: /opt/machinenativenops/modules/monitoring-service/main.py
    environment:
    - name: METRICS_PORT
      value: '9090'
    - name: SCRAPE_INTERVAL
      value: 15s
    group: monitoring
    health_check:
      endpoint: /health
      interval: 30s
      retries: 3
      timeout: 10s
    name: monitoring-service
    priority: 50
    resources:
      cpu:
        limit: 500m
        request: 100m
      memory:
        limit: 512Mi
        request: 128Mi
    version: 1.0.0
  - auto_start: true
    dependencies:
    - name: config-manager
      optional: false
      version: '>=1.0.0'
    - name: logging-service
      optional: false
      version: '>=1.0.0'
    - name: database-connector
      optional: false
      version: '>=1.0.0'
    description: Production-ready auto-monitoring with quantum state tracking
    enabled: true
    entrypoint: /usr/bin/machinenativenops-auto-monitor
    environment:
    - name: MNO_PROMETHEUS_PORT
      value: '8000'
    - name: MNO_LOG_LEVEL
      value: INFO
    - name: QUANTUM_ENABLED
      value: 'false'
    - name: AUTO_REPAIR_ENABLED
      value: 'false'
    - name: MNO_DATABASE_PATH
      value: /var/lib/machinenativenops/auto_monitor/metrics.db
    group: monitoring
    health_check:
      endpoint: /health
      interval: 30s
      retries: 3
      timeout: 10s
    name: machinenativenops-auto-monitor
    priority: 55
    resources:
      cpu:
        limit: 1000m
        request: 200m
      memory:
        limit: 1Gi
        request: 256Mi
      storage:
        limit: 5Gi
        request: 500Mi
    version: 2.0.0
  monitoring:
    alerts:
    - action: restart_module
      condition: module_health_status == 0 for 2m
      name: module_down
      severity: critical
    - action: notify_administrator
      condition: module_memory_usage > 90% for 5m
      name: high_memory_usage
      severity: warning
    - action: scale_up_if_possible
      condition: module_cpu_usage > 80% for 10m
      name: high_cpu_usage
      severity: warning
    metrics:
    - description: Module uptime in seconds
      name: module_uptime
      type: counter
    - description: Number of module restarts
      name: module_restart_count
      type: counter
    - description: Current memory usage
      name: module_memory_usage
      type: gauge
    - description: Current CPU usage
      name: module_cpu_usage
      type: gauge
    - description: Health status (1=healthy, 0=unhealthy)
      name: module_health_status
      type: gauge
  version_management:
    compatibility:
    - major_version_breaks_compatibility: true
    - minor_version_adds_features: true
    - patch_version_fixes_bugs: true
    rollback_policy:
    - auto_rollback_on_failure: true
    - max_rollback_attempts: 3
    - rollback_timeout: 300s
    strategy: semantic_versioning
    upgrade_policy:
    - auto_patch_upgrades: true
    - minor_version_approval_required: true
    - major_version_manual_approval: true
status:
  conditions:
  - lastTransitionTime: '2025-12-20T22:00:00Z'
    message: All modules successfully registered
    reason: RegistrationComplete
    status: 'True'
    type: ModulesRegistered
  - lastTransitionTime: '2025-12-20T22:00:00Z'
    message: Module dependency graph is valid and resolved
    reason: DependencyGraphValid
    status: 'True'
    type: DependenciesResolved
  - lastTransitionTime: '2025-12-20T22:00:00Z'
    message: Module load sequence is valid
    reason: SequenceValid
    status: 'True'
    type: LoadSequenceValidated
  phase: Ready
---
apiVersion: v1
data:
  schema.yaml: "# Root Modules Configuration Schema\ntype: object\nproperties:\n \
    \ modules:\n    type: array\n    items:\n      type: object\n      properties:\n\
    \        name:\n          type: string\n          pattern: \"^[a-z0-9-]+$\"\n\
    \        version:\n          type: string\n          pattern: \"^\\\\d+\\\\.\\\
    \\d+\\\\.\\\\d+$\"\n        description:\n          type: string\n        entrypoint:\n\
    \          type: string\n        group:\n          type: string\n        priority:\n\
    \          type: integer\n          minimum: 0\n          maximum: 100\n     \
    \   enabled:\n          type: boolean\n        auto_start:\n          type: boolean\n\
    \        dependencies:\n          type: array\n          items:\n            type:\
    \ object\n            properties:\n              name:\n                type:\
    \ string\n              version:\n                type: string\n             \
    \ optional:\n                type: boolean\n        resources:\n          type:\
    \ object\n          properties:\n            cpu:\n              type: object\n\
    \              properties:\n                request:\n                  type:\
    \ string\n                limit:\n                  type: string\n           \
    \ memory:\n              type: object\n              properties:\n           \
    \     request:\n                  type: string\n                limit:\n     \
    \             type: string\n      required: [\"name\", \"version\", \"description\"\
    , \"entrypoint\", \"group\", \"priority\", \"enabled\", \"auto_start\", \"dependencies\"\
    , \"resources\"]\n  groups:\n    type: array\n    items:\n      type: object\n\
    \      properties:\n        name:\n          type: string\n        description:\n\
    \          type: string\n        priority:\n          type: integer\n        criticality:\n\
    \          type: string\n          enum: [\"critical\", \"high\", \"medium\",\
    \ \"low\"]\n        auto_start:\n          type: boolean\n        fail_fast:\n\
    \          type: boolean\n      required: [\"name\", \"description\", \"priority\"\
    , \"criticality\", \"auto_start\", \"fail_fast\"]\nrequired: [\"modules\", \"\
    groups\"]"
kind: ConfigMap
metadata:
  annotations:
    eco-base/audit-log-level: minimal
    eco-base/governance-policy: standard-v1
    eco-base/uri: eco-base://k8s/core/configmap/modules-schema
    eco-base/urn: urn:eco-base:k8s:core:configmap:modules-schema:sha256-504f7e22c71e180fef380cb3486c61b473341342d3c6f9688ff78a7c4bb37fe5
  labels:
    app.kubernetes.io/component: eco-component
    app.kubernetes.io/instance: eco-instance
    app.kubernetes.io/name: modules-schema
    app.kubernetes.io/part-of: eco-base
    app.kubernetes.io/version: 1.0.0
    eco-base/environment: development
    eco-base/owner: eco-system
    eco-base/platform: core
  name: modules-schema
  namespace: machinenativenops-modules
