---
apiVersion: machinenativeops.io/v1
kind: RootProvenanceConfig
metadata:
  annotations:
    machinenativeops.io/description: Root layer provenance, metadata and audit trail
      configuration
    machinenativeops.io/last-modified: '2025-12-20T22:00:00Z'
  labels:
    eco-base/governance: aligned
    eco-base/part-of: eco-base
    machinenativeops.io/component: provenance-configuration
    machinenativeops.io/tier: provenance
    machinenativeops.io/version: v1.0.0
  name: provenance-baseline-config
  namespace: machinenativenops-provenance
spec:
  audit_trails:
  - access_control:
      deletion_access:
      - none
      read_access:
      - auditors
      - compliance_officers
      - security_administrators
      write_access:
      - system_only
    collection_methods:
    - system_event_hooks
    - api_request_logging
    - database_audit_logging
    - file_system_monitoring
    description: Comprehensive trail of all system operations
    enabled: true
    immutable_storage:
      backup_strategy: geo_replicated
      enabled: true
      storage_type: worm_storage
      verification_method: blockchain_hash
    name: system-operations-trail
    retention_period: 7y
    scope: all_operations
  - access_control:
      deletion_access:
      - none
      read_access:
      - security_administrators
      - incident_response_team
      - compliance_officers
      write_access:
      - security_systems_only
    collection_methods:
    - security_event_hooks
    - authentication_logging
    - authorization_logging
    - intrusion_detection_logs
    description: Security-related events and incidents
    enabled: true
    immutable_storage:
      backup_strategy: multi_region
      enabled: true
      storage_type: append_only
      verification_method: merkle_tree
    name: security-events-trail
    retention_period: 10y
    scope: security_operations
  - access_control:
      deletion_access:
      - compliance_officers_with_approval
      read_access:
      - compliance_officers
      - auditors
      - legal_team
      write_access:
      - compliance_systems_only
    collection_methods:
    - compliance_event_hooks
    - policy_violation_logging
    - regulatory_report_generation
    - risk_assessment_logging
    description: Compliance-specific audit trail
    enabled: true
    immutable_storage:
      backup_strategy: regional_compliance
      enabled: true
      storage_type: compliance_archive
      verification_method: digital_signature_chain
    name: compliance-audit-trail
    retention_period: 7y
    scope: compliance_operations
  cross_system_references:
    governance_system_integration:
    - bidirectional: true
      governance_reference_field: policy_id
      provenance_reference_field: applicable_policy_id
      reference_type: policy_application
      validation_required: true
    - bidirectional: true
      governance_reference_field: role_id
      provenance_reference_field: actor_role_id
      reference_type: role_based_access
      validation_required: true
    integrity_system_integration:
    - bidirectional: true
      integrity_reference_field: integrity_check_id
      provenance_reference_field: related_integrity_check
      reference_type: integrity_verification
      validation_required: true
    - bidirectional: false
      integrity_reference_field: baseline_hash
      provenance_reference_field: baseline_reference_hash
      reference_type: baseline_tracking
      validation_required: true
    trust_system_integration:
    - bidirectional: true
      provenance_reference_field: trust_certificate_id
      reference_type: certificate_chain
      trust_reference_field: certificate_id
      validation_required: true
    - bidirectional: false
      provenance_reference_field: event_signature
      reference_type: signature_verification
      trust_reference_field: signature_value
      validation_required: true
  data_retention:
    archival_procedures:
    - compression: true
      encryption: true
      integrity_verification: true
      procedure_name: standard_archival
      retrieval_sla: 24h
      storage_location: regional_archive
    - additional_metadata: compliance_tags
      compression: true
      encryption: true
      integrity_verification: true
      procedure_name: compliance_archival
      retrieval_sla: 48h
      storage_location: compliance_archive
    policies:
    - archival_after: 2y
      archival_storage: cold_storage
      compliance_requirement: SOX, GDPR
      data_type: source_code_provenance
      deletion_after: 7y
      deletion_method: secure_erase
      retention_period: 7y
    - archival_after: 1y
      archival_storage: cold_storage
      compliance_requirement: ISO27001
      data_type: build_provenance
      deletion_after: 5y
      deletion_method: secure_erase
      retention_period: 5y
    - archival_after: 2y
      archival_storage: cold_storage
      compliance_requirement: SOX
      data_type: deployment_provenance
      deletion_after: 5y
      deletion_method: secure_erase
      retention_period: 5y
    - archival_after: 6m
      archival_storage: cold_storage
      compliance_requirement: GDPR
      data_type: access_provenance
      deletion_after: 2y
      deletion_method: secure_erase
      retention_period: 2y
    - archival_after: 3y
      archival_storage: cold_storage
      compliance_requirement: PCI-DSS, HIPAA
      data_type: security_provenance
      deletion_after: 10y
      deletion_method: secure_erase
      retention_period: 10y
  metadata_schema:
    common_fields:
    - description: Unique identifier for the provenance event
      indexed: true
      name: event_id
      required: true
      type: uuid
    - description: Timestamp when the event occurred
      indexed: true
      name: event_timestamp
      required: true
      type: timestamp
    - description: Type of provenance event
      enum:
      - commit
      - build
      - deploy
      - config_change
      - access
      indexed: true
      name: event_type
      required: true
      type: string
    - description: System that generated the event
      indexed: true
      name: source_system
      required: true
      type: string
    - description: Identity of the actor who performed the action
      indexed: true
      name: actor_identity
      required: true
      type: string
    - description: Identifier of the affected resource
      indexed: true
      name: resource_id
      required: true
      type: string
    - description: Type of the affected resource
      indexed: true
      name: resource_type
      required: true
      type: string
    - description: Action performed on the resource
      indexed: true
      name: action
      required: true
      type: string
    - description: Outcome of the action
      enum:
      - success
      - failure
      - partial
      indexed: true
      name: outcome
      required: true
      type: string
    - description: Cryptographic hash of relevant data
      indexed: true
      name: hash_value
      required: false
      type: string
    - description: Digital signature of the event
      indexed: false
      name: signature_value
      required: false
      type: string
    - description: IDs of parent events in the chain
      indexed: false
      name: parent_event_ids
      required: false
      type: array
    - description: Additional event-specific metadata
      indexed: false
      name: metadata
      required: false
      type: json
    type_specific_schemas:
      build:
      - description: Build identifier
        name: build_id
        type: string
      - description: Name of the build pipeline
        name: pipeline_name
        type: string
      - description: Build environment configuration
        name: build_environment
        type: json
      - description: Hashes of build artifacts
        name: artifact_hashes
        type: object
      - description: Test execution results
        name: test_results
        type: json
      commit:
      - description: URL of the source repository
        name: repository_url
        type: string
      - description: Name of the branch
        name: branch_name
        type: string
      - description: Commit message
        name: commit_message
        type: text
      - description: List of changed files
        name: files_changed
        type: array
      - description: Code diff information
        name: code_diff
        type: text
      deploy:
      - description: Deployment identifier
        name: deployment_id
        type: string
      - description: Target deployment environment
        name: target_environment
        type: string
      - description: Deployment strategy used
        name: deployment_strategy
        type: string
      - description: Rollback information
        name: rollback_info
        type: json
      - description: Health check results
        name: health_checks
        type: json
  provenance_sources:
  - collection_frequency: on_commit
    data_points:
    - commit_hash
    - author_identity
    - commit_timestamp
    - branch_name
    - tag_information
    - commit_message
    - parent_commits
    - file_changes
    - code_signatures
    - vulnerability_scans
    description: Source code repository provenance
    enabled: true
    name: source-code-repository
    storage_backend:
      compression: true
      encryption: true
      retention_period: 7y
      type: postgresql
    type: git
    verification_methods:
    - git_signature_verification
    - commit_hash_verification
    - author_identity_verification
  - collection_frequency: on_build
    data_points:
    - build_id
    - pipeline_definition
    - build_environment
    - build_tools_versions
    - source_commit
    - build_artifacts
    - test_results
    - security_scan_results
    - build_duration
    - build_operator
    - quality_gates_status
    description: Build pipeline execution provenance
    enabled: true
    name: build-pipeline
    storage_backend:
      compression: true
      encryption: true
      retention_period: 5y
      type: postgresql
    type: ci_cd
    verification_methods:
    - pipeline_signature_verification
    - artifact_hash_verification
    - quality_gate_verification
  - collection_frequency: on_deployment
    data_points:
    - deployment_id
    - deployment_environment
    - deployed_artifact
    - deployment_strategy
    - deployment_configuration
    - deployment_operator
    - deployment_timestamp
    - rollback_information
    - health_check_results
    - performance_metrics
    description: Deployment operations provenance
    enabled: true
    name: deployment-events
    storage_backend:
      compression: true
      encryption: true
      retention_period: 5y
      type: postgresql
    type: deployment
    verification_methods:
    - deployment_approval_verification
    - artifact_integrity_verification
    - configuration_signature_verification
  - collection_frequency: on_change
    data_points:
    - config_file_path
    - config_before_hash
    - config_after_hash
    - change_description
    - change_author
    - change_approval
    - change_timestamp
    - change_reason
    - rollback_capability
    - impact_assessment
    description: Configuration management provenance
    enabled: true
    name: configuration-changes
    storage_backend:
      compression: true
      encryption: true
      retention_period: 7y
      type: postgresql
    type: configuration
    verification_methods:
    - change_signature_verification
    - approval_chain_verification
    - impact_assessment_verification
  - collection_frequency: on_access
    data_points:
    - user_identity
    - authentication_method
    - access_timestamp
    - accessed_resource
    - access_type
    - access_result
    - session_id
    - client_information
    - geo_location
    - risk_score
    description: System access and authentication provenance
    enabled: true
    name: access-events
    storage_backend:
      compression: true
      encryption: true
      retention_period: 2y
      type: elasticsearch
    type: access
    verification_methods:
    - authentication_verification
    - authorization_verification
    - session_integrity_verification
  query_capabilities:
  - description: Trace all operations on a specific resource
    output_format: chronological_list
    parameters:
    - name: resource_id
      required: true
      type: string
    - name: time_range
      required: false
      type: daterange
    - name: event_types
      required: false
      type: array
    query_name: trace-by-resource
  - description: Trace all operations by a specific actor
    output_format: chronological_list
    parameters:
    - name: actor_identity
      required: true
      type: string
    - name: time_range
      required: false
      type: daterange
    - name: resource_types
      required: false
      type: array
    query_name: trace-by-actor
  - description: Generate compliance reports
    output_format: compliance_report
    parameters:
    - name: compliance_framework
      required: true
      type: string
    - name: reporting_period
      required: true
      type: daterange
    - enum:
      - json
      - csv
      - pdf
      name: report_format
      required: false
      type: string
    query_name: compliance-report
  - description: Verify integrity of provenance data
    output_format: verification_report
    parameters:
    - enum:
      - all
      - time_range
      - specific_events
      name: verification_scope
      required: true
      type: string
    - enum:
      - hash_verification
      - signature_verification
      - blockchain_verification
      name: verification_method
      required: true
      type: string
    query_name: integrity-verification
status:
  conditions:
  - lastTransitionTime: '2025-12-20T22:00:00Z'
    message: All provenance sources configured and operational
    reason: SourcesConfigured
    status: 'True'
    type: ProvenanceSourcesConfigured
  - lastTransitionTime: '2025-12-20T22:00:00Z'
    message: Metadata schema defined and validated
    reason: SchemaValidated
    status: 'True'
    type: MetadataSchemaDefined
  - lastTransitionTime: '2025-12-20T22:00:00Z'
    message: All audit trails are active and collecting data
    reason: TrailsOperational
    status: 'True'
    type: AuditTrailsActive
  phase: Active
---
apiVersion: v1
data:
  schema.yaml: "# Root Provenance Configuration Schema\ntype: object\nproperties:\n\
    \  provenance_sources:\n    type: array\n    items:\n      type: object\n    \
    \  properties:\n        name:\n          type: string\n        description:\n\
    \          type: string\n        type:\n          type: string\n          enum:\
    \ [\"git\", \"ci_cd\", \"deployment\", \"configuration\", \"access\"]\n      \
    \  enabled:\n          type: boolean\n        collection_frequency:\n        \
    \  type: string\n        data_points:\n          type: array\n        storage_backend:\n\
    \          type: object\n        verification_methods:\n          type: array\n\
    \      required: [\"name\", \"description\", \"type\", \"enabled\", \"collection_frequency\"\
    , \"data_points\"]\n  metadata_schema:\n    type: object\n    properties:\n  \
    \    common_fields:\n        type: array\n        items:\n          type: object\n\
    \          properties:\n            name:\n              type: string\n      \
    \      type:\n              type: string\n            description:\n         \
    \     type: string\n            required:\n              type: boolean\n     \
    \       indexed:\n              type: boolean\n          required: [\"name\",\
    \ \"type\", \"description\", \"required\", \"indexed\"]\n      type_specific_schemas:\n\
    \        type: object\n    required: [\"common_fields\", \"type_specific_schemas\"\
    ]\n  audit_trails:\n    type: array\n    items:\n      type: object\n      properties:\n\
    \        name:\n          type: string\n        description:\n          type:\
    \ string\n        enabled:\n          type: boolean\n        scope:\n        \
    \  type: string\n        retention_period:\n          type: string\n        collection_methods:\n\
    \          type: array\n        immutable_storage:\n          type: object\n \
    \       access_control:\n          type: object\n      required: [\"name\", \"\
    description\", \"enabled\", \"scope\", \"retention_period\"]\nrequired: [\"provenance_sources\"\
    , \"metadata_schema\", \"audit_trails\"]"
kind: ConfigMap
metadata:
  annotations:
    eco-base/audit-log-level: minimal
    eco-base/governance-policy: standard-v1
    eco-base/uri: eco-base://k8s/core/configmap/provenance-schema
    eco-base/urn: urn:eco-base:k8s:core:configmap:provenance-schema:sha256-cc3be94ce333f5371cfc2f6ea7f5cf3e67e513710549c18347a88658b5ea4797
  labels:
    app.kubernetes.io/component: eco-component
    app.kubernetes.io/instance: eco-instance
    app.kubernetes.io/name: provenance-schema
    app.kubernetes.io/part-of: eco-base
    app.kubernetes.io/version: 1.0.0
    eco-base/environment: development
    eco-base/owner: eco-system
    eco-base/platform: core
  name: provenance-schema
  namespace: machinenativenops-provenance
