---
apiVersion: machinenativeops.io/v1
kind: RootGovernanceConfig
metadata:
  annotations:
    machinenativeops.io/description: Root layer governance, permissions and policies
      configuration
    machinenativeops.io/last-modified: '2025-12-20T22:00:00Z'
  labels:
    eco-base/governance: aligned
    eco-base/part-of: eco-base
    machinenativeops.io/component: governance-configuration
    machinenativeops.io/tier: governance
    machinenativeops.io/version: v1.0.0
  name: governance-framework-baseline-config
  namespace: machinenativenops-governance
spec:
  audit_rules:
  - alert_actions:
    - notify_security_team
    - lock_account_temporarily
    alert_threshold: 10
    description: Audit all system access attempts
    enabled: true
    events:
    - login_success
    - login_failure
    - permission_granted
    - permission_denied
    - session_created
    - session_terminated
    name: system-access-audit
    retention: 2_years
    scope:
    - authentication
    - authorization
    - session_management
  - alert_actions:
    - notify_data_protection_officer
    - create_incident_ticket
    alert_threshold: 5
    description: Audit all sensitive data access
    enabled: true
    events:
    - sensitive_data_read
    - sensitive_data_write
    - data_export
    - data_deletion
    name: data-access-audit
    retention: 7_years
    scope:
    - data_access
    - data_modification
    - data_export
  - alert_actions:
    - notify_system_administrator
    - create_change_record
    alert_threshold: 1
    description: Audit all configuration changes
    enabled: true
    events:
    - config_modified
    - policy_created
    - policy_modified
    - policy_deleted
    - role_assigned
    - role_revoked
    name: configuration-change-audit
    retention: 5_years
    scope:
    - system_configuration
    - policy_configuration
    - role_configuration
  compliance_requirements:
  - audit_frequency: quarterly
    controls:
    - data_protection_impact_assessment
    - data_subject_rights_implementation
    - data_breach_notification_procedure
    - privacy_by_design
    - data_protection_officer_designation
    description: General Data Protection Regulation compliance
    enabled: true
    name: GDPR
    reporting_requirements:
    - annual_compliance_report
    - data_protection_impact_assessment_report
  - audit_frequency: annual
    controls:
    - security_controls
    - availability_controls
    - processing_integrity_controls
    - confidentiality_controls
    - privacy_controls
    description: SOC2 Type II compliance
    enabled: true
    external_auditor: true
    name: SOC2-Type2
    reporting_requirements:
    - soc2_type2_report
    - management_assertion_letter
  - audit_frequency: annual
    certification_body: accredited_certification_body
    controls:
    - information_security_policy
    - risk_assessment_and_treatment
    - security_objectives
    - competence_and_training
    - incident_management
    description: ISO 27001 Information Security Management
    enabled: true
    name: ISO27001
    reporting_requirements:
    - iso27001_certificate
    - statement_of_applicability
  delegation_map:
  - approval_required: false
    audit_level: detailed
    conditions:
    - emergency_declared = true
    - delegator_role in ['system-administrator', 'security-administrator']
    - delegatee_trust_level >= 'high'
    delegatable_permissions:
    - system:read
    - system:execute_emergency_operations
    - execution:read
    - execution:execute_critical
    description: Emergency access delegation for critical situations
    duration: 24h
    enabled: true
    name: emergency-access-delegation
  - approval_required: true
    approvers:
    - security-administrator
    - audit-committee
    audit_level: comprehensive
    conditions:
    - business_justification_provided = true
    - delegator_role = 'system-administrator'
    - delegatee_background_check_passed = true
    delegatable_permissions:
    - modules:*
    - execution:read
    - execution:execute
    description: Temporary administrative privileges delegation
    duration: 72h
    enabled: true
    name: temporary-admin-delegation
  governance_workflows:
  - description: Access request approval workflow
    escalation_policy:
    - 'timeout_escalation_to: director'
    - 'rejection_threshold: 3_denials'
    name: access-request-workflow
    steps:
    - assignee: team_lead
      name: initial_review
      timeout: 24h
    - assignee: security_administrator
      name: security_review
      timeout: 48h
    - assignee: system_administrator
      name: final_approval
      timeout: 24h
    triggers:
    - new_access_request_submitted
  - description: Policy change approval workflow
    escalation_policy:
    - 'timeout_escalation_to: executive_committee'
    - 'consensus_required: true'
    name: policy-change-workflow
    steps:
    - assignee: policy_analyst
      name: impact_assessment
      timeout: 72h
    - assignee: affected_stakeholders
      name: stakeholder_review
      timeout: 1_week
    - assignee: governance_board
      name: governance_board_approval
      timeout: 2_weeks
    triggers:
    - policy_change_requested
  - description: Evidence chain and documentation requirements
    name: evidence-chain-policy
    rules:
    - action: validate_four_core_evidences
      condition: change.type in ['code', 'config', 'governance']
      description: 'Require four core evidences: repo, branch, commit, PR'
      effect: require
      id: EVP-001
      name: require-four-core-evidences
      priority: 100
    - action: validate_agents_documentation
      condition: change.ai_related = true
      description: Require AGENTS.md compliance for AI-related changes
      effect: require
      id: EVP-002
      name: require-agents-compliance
      priority: 95
    - action: validate_status_consistency
      condition: change.source = 'pull_request'
      description: Require status and checklist logical consistency
      effect: require
      id: EVP-003
      name: require-status-consistency
      priority: 90
  - description: Evidence chain and documentation requirements
    name: evidence-chain-policy
    rules:
    - action: validate_four_core_evidences
      condition: change.type in ['code', 'config', 'governance']
      description: 'Require four core evidences: repo, branch, commit, PR'
      effect: require
      id: EVP-001
      name: require-four-core-evidences
      priority: 100
    - action: validate_agents_documentation
      condition: change.ai_related = true
      description: Require AGENTS.md compliance for AI-related changes
      effect: require
      id: EVP-002
      name: require-agents-compliance
      priority: 95
    - action: validate_status_consistency
      condition: change.source = 'pull_request'
      description: Require status and checklist logical consistency
      effect: require
      id: EVP-003
      name: require-status-consistency
      priority: 90
  policies:
  - description: Access control and permission management
    name: access-control-policy
    rules:
    - action: require_mfa
      condition: user.roles contains 'system-administrator' OR user.roles contains
        'security-administrator'
      description: Require MFA for administrative operations
      effect: allow
      id: ACL-001
      name: require-mfa-admin
      priority: 100
    - action: audit_log
      condition: operation.sensitivity >= 'high'
      description: Audit all sensitive operations
      effect: allow
      id: ACL-002
      name: audit-sensitive-operations
      priority: 90
    - action: deny
      condition: operation.criticality = 'high' AND time.now not in business_hours
      description: Restrict critical operations to business hours
      effect: deny
      id: ACL-003
      name: time-restricted-access
      priority: 80
  - description: Data protection and privacy controls
    name: data-protection-policy
    rules:
    - action: encrypt
      condition: data.sensitivity >= 'high'
      description: Encrypt all sensitive data at rest and in transit
      effect: require
      id: DPP-001
      name: encrypt-sensitive-data
      priority: 100
    - action: 'retention_period: 7_years'
      condition: data.type = 'audit_log'
      description: Enforce data retention periods
      effect: require
      id: DPP-002
      name: data-retention-policy
      priority: 90
  - description: Change management and approval workflow
    name: change-management-policy
    rules:
    - action: require_approval
      condition: environment = 'production' AND change.type in ['config', 'code',
        'infrastructure']
      description: Require approval for production changes
      effect: require
      id: CMP-001
      name: require-change-approval
      priority: 100
    - action: validate_change
      condition: change.status = 'pending'
      description: Validate all changes before deployment
      effect: require
      id: CMP-002
      name: change-validation
      priority: 90
  risk_management:
  - assessment_frequency: monthly
    categories:
    - human_error
    - system_failure
    - process_failure
    - external_events
    description: Operational risk management
    mitigation_strategies:
    - automation
    - redundancy
    - training
    - monitoring
    name: operational_risk
  - assessment_frequency: weekly
    categories:
    - malicious_attacks
    - data_breaches
    - unauthorized_access
    - vulnerabilities
    description: Security risk management
    mitigation_strategies:
    - security_controls
    - threat_intelligence
    - vulnerability_management
    - incident_response
    name: security_risk
  roles:
  - constraints:
    - 'audit_required: true'
    - 'mfa_required: true'
    - 'time_window: business_hours'
    description: Complete system administration privileges
    name: system-administrator
    permissions:
    - system:*
    - governance:*
    - modules:*
    - trust:*
    - provenance:*
    - execution:*
    - integrity:*
  - constraints:
    - 'audit_required: true'
    - 'mfa_required: true'
    description: Security and trust management privileges
    name: security-administrator
    permissions:
    - trust:*
    - integrity:*
    - governance:read
    - provenance:read
    - system:read
  - constraints:
    - 'audit_required: false'
    - 'approval_required: true'
    description: Module development and management privileges
    name: module-developer
    permissions:
    - modules:*
    - execution:read
    - governance:read
    - provenance:read
    - trust:read
  - constraints:
    - 'audit_required: true'
    - 'read_only: true'
    description: Audit and compliance verification privileges
    name: auditor
    permissions:
    - governance:read
    - provenance:*
    - trust:read
    - integrity:read
    - system:read
    - modules:read
    - execution:read
  - constraints:
    - 'audit_required: true'
    - 'approval_required: false'
    description: System operation and monitoring privileges
    name: operator
    permissions:
    - execution:read
    - execution:execute
    - governance:read
    - system:read
    - modules:read
status:
  conditions:
  - lastTransitionTime: '2025-12-20T22:00:00Z'
    message: All governance roles configured successfully
    reason: RolesSetupComplete
    status: 'True'
    type: RolesConfigured
  - lastTransitionTime: '2025-12-20T22:00:00Z'
    message: All governance policies are active and enforced
    reason: PoliciesEnabled
    status: 'True'
    type: PoliciesActive
  - lastTransitionTime: '2025-12-20T22:00:00Z'
    message: Audit system is operational and collecting events
    reason: AuditSystemOperational
    status: 'True'
    type: AuditEnabled
  phase: Active
---
apiVersion: v1
data:
  schema.yaml: "# Root Governance Configuration Schema\ntype: object\nproperties:\n\
    \  roles:\n    type: array\n    items:\n      type: object\n      properties:\n\
    \        name:\n          type: string\n          pattern: \"^[a-z0-9-]+$\"\n\
    \        description:\n          type: string\n        permissions:\n        \
    \  type: array\n          items:\n            type: string\n        constraints:\n\
    \          type: array\n          items:\n            type: string\n      required:\
    \ [\"name\", \"description\", \"permissions\", \"constraints\"]\n  policies:\n\
    \    type: array\n    items:\n      type: object\n      properties:\n        name:\n\
    \          type: string\n        description:\n          type: string\n      \
    \  rules:\n          type: array\n      required: [\"name\", \"description\",\
    \ \"rules\"]\n  audit_rules:\n    type: array\n    items:\n      type: object\n\
    \      properties:\n        name:\n          type: string\n        description:\n\
    \          type: string\n        enabled:\n          type: boolean\n        scope:\n\
    \          type: array\n        events:\n          type: array\n        retention:\n\
    \          type: string\n      required: [\"name\", \"description\", \"enabled\"\
    , \"scope\", \"events\"]\nrequired: [\"roles\", \"policies\", \"audit_rules\"]"
kind: ConfigMap
metadata:
  annotations:
    eco-base/audit-log-level: minimal
    eco-base/governance-policy: standard-v1
    eco-base/uri: eco-base://k8s/core/configmap/governance-schema
    eco-base/urn: urn:eco-base:k8s:core:configmap:governance-schema:sha256-aefa1bd4fc990d187662e1bdd036dd6011abc4f610813c28b2b27fdfbe75cb3c
  labels:
    app.kubernetes.io/component: eco-component
    app.kubernetes.io/instance: eco-instance
    app.kubernetes.io/name: governance-schema
    app.kubernetes.io/part-of: eco-base
    app.kubernetes.io/version: 1.0.0
    eco-base/environment: development
    eco-base/owner: eco-system
    eco-base/platform: core
  name: governance-schema
  namespace: machinenativenops-governance
