---
apiVersion: v1
kind: Namespace
metadata:
  labels:
    app.kubernetes.io/part-of: machine-native-ops
    app.kubernetes.io/version: v4.0.0-quantum
    eco-base/governance: aligned
    eco-base/part-of: eco-base
    name: quantum-governance
  name: quantum-governance
---
apiVersion: v1
kind: ServiceAccount
metadata:
  labels:
    app.kubernetes.io/component: service-account
    app.kubernetes.io/name: quantum-governance
    eco-base/governance: aligned
    eco-base/part-of: eco-base
  name: quantum-governance-sa
  namespace: quantum-governance
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    app.kubernetes.io/component: rbac
    app.kubernetes.io/name: quantum-governance
    eco-base/governance: aligned
    eco-base/part-of: eco-base
  name: quantum-governance-role
rules:
- apiGroups:
  - ''
  resources:
  - pods
  - services
  - configmaps
  - secrets
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - apps
  resources:
  - deployments
  - replicasets
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - batch
  resources:
  - jobs
  - cronjobs
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - networking.k8s.io
  resources:
  - ingresses
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - monitoring.coreos.com
  resources:
  - prometheusrules
  - servicemonitors
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    app.kubernetes.io/component: rbac
    app.kubernetes.io/name: quantum-governance
    eco-base/governance: aligned
    eco-base/part-of: eco-base
  name: quantum-governance-binding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: quantum-governance-role
subjects:
- kind: ServiceAccount
  name: quantum-governance-sa
  namespace: quantum-governance
---
apiVersion: v1
data:
  naming-policies.yaml: "policies:\n  - name: \"quantum-naming-convention\"\n    description:\
    \ \"Quantum-enhanced naming convention validation\"\n    rules:\n      - name:\
    \ \"pattern-validation\"\n        regex: \"^[a-z0-9]+(-[a-z0-9]+)*(\\\\.[a-z0-9]+)*(\\\
    \\_[a-z0-9]+)*$\"\n        description: \"Valid naming pattern with quantum support\"\
    \n      - name: \"length-validation\"\n        max_length: 63\n        description:\
    \ \"Maximum length for DNS compatibility\"\n      - name: \"quantum-coherence\"\
    \n        threshold: 0.9999\n        description: \"Quantum coherence threshold\"\
    \n  \n  - name: \"quantum-entanglement-policy\"\n    description: \"Quantum entanglement\
    \ validation rules\"\n    rules:\n      - name: \"entanglement-strength\"\n  \
    \      threshold: 0.95\n        description: \"Minimum entanglement strength\"\
    \n      - name: \"bell-inequality\"\n        threshold: 2.0\n        description:\
    \ \"Bell inequality minimum value\"\n"
  quantum-config.yaml: "quantum:\n  backend: \"ibm_quantum_falcon\"\n  entanglement_depth:\
    \ 7\n  coherence_threshold: 0.9999\n  error_correction: \"surface_code_v5\"\n\
    \  measurement_basis: \"bell_states\"\n  qubits: 256\n  shots: 1024\n\ngovernance:\n\
    \  naming_scheme:\n    hierarchy: \"env/app/resource/version/quantum-id\"\n  \
    \  separators:\n      primary: \"-\"\n      secondary: \".\"\n      tertiary:\
    \ \"_\"\n    validation_regex: \"^[a-z0-9]+(-[a-z0-9]+)*(\\\\.[a-z0-9]+)*(\\\\\
    _[a-z0-9]+)*$\"\n  \n  layers:\n    strategic:\n      adoption_phases: [\"planning\"\
    , \"pilot\", \"rollout\", \"optimization\"]\n      decision_matrix:\n        risk_model:\
    \ \"quantum-entropy-v4\"\n        approval_gates: [\"CAB-Quantum\", \"AI-Governor-v7\"\
    , \"Security-Council-Quantum\"]\n    \n    operational:\n      version_control:\n\
    \        semver_quantum: true\n        coherence_checker: \"qsvm-validator@0.8.2\"\
    \n    \n    technical:\n      automation_pipeline:\n        stages:\n        \
    \  - \"quantum-canonicalization\"\n          - \"cross-layer-quantum-validation\"\
    \n          - \"observability-quantum-injection\"\n          - \"quantum-auto-repair\"\
    \n\nobservability:\n  prometheus:\n    enabled: true\n    port: 9090\n  grafana:\n\
    \    enabled: true\n    port: 3000\n  jaeger:\n    enabled: true\n    port: 16686\n"
kind: ConfigMap
metadata:
  annotations:
    eco-base/audit-log-level: minimal
    eco-base/governance-policy: standard-v1
    eco-base/uri: eco-base://k8s/core/configmap/quantum-governance-config
    eco-base/urn: urn:eco-base:k8s:core:configmap:quantum-governance-config:sha256-b55d47d13fca67b50c78c9640bade225badd0b5a8eb106bf2be5492e1055c7f2
  labels:
    app.kubernetes.io/component: config
    app.kubernetes.io/instance: eco-instance
    app.kubernetes.io/name: quantum-governance
    app.kubernetes.io/part-of: eco-base
    app.kubernetes.io/version: 1.0.0
    eco-base/environment: development
    eco-base/governance: aligned
    eco-base/owner: eco-system
    eco-base/part-of: eco-base
    eco-base/platform: core
  name: quantum-governance-config
  namespace: quantum-governance
---
apiVersion: v1
data:
  qkd-secret: ''
  quantum-api-token: ''
  quantum-signature-key: ''
kind: Secret
metadata:
  annotations:
    eco-base/audit-log-level: minimal
    eco-base/governance-policy: standard-v1
    eco-base/uri: eco-base://k8s/core/secret/quantum-governance-secrets
    eco-base/urn: urn:eco-base:k8s:core:secret:quantum-governance-secrets:sha256-5a7597d7f426d8a0dc20e74f4317e343b8811ab71c123e5ddc5011d22cb0c467
  labels:
    app.kubernetes.io/component: secrets
    app.kubernetes.io/instance: eco-instance
    app.kubernetes.io/name: quantum-governance
    app.kubernetes.io/part-of: eco-base
    app.kubernetes.io/version: 1.0.0
    eco-base/environment: development
    eco-base/governance: aligned
    eco-base/owner: eco-system
    eco-base/part-of: eco-base
    eco-base/platform: core
  name: quantum-governance-secrets
  namespace: quantum-governance
type: Opaque
---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    eco-base/audit-log-level: minimal
    eco-base/governance-policy: standard-v1
    eco-base/uri: eco-base://k8s/core/deployment/quantum-governance-service
    eco-base/urn: urn:eco-base:k8s:core:deployment:quantum-governance-service:sha256-c22cefe4bf8348d9414eaeb5f7d92c053465f943e750e4e9ef4d077025c87873
  labels:
    app.kubernetes.io/component: service
    app.kubernetes.io/instance: eco-instance
    app.kubernetes.io/name: quantum-governance
    app.kubernetes.io/part-of: eco-base
    app.kubernetes.io/version: v4.0.0-quantum
    eco-base/environment: development
    eco-base/governance: aligned
    eco-base/owner: eco-system
    eco-base/part-of: eco-base
    eco-base/platform: core
  name: quantum-governance-service
  namespace: quantum-governance
spec:
  replicas: 3
  selector:
    matchLabels:
      app.kubernetes.io/component: service
      app.kubernetes.io/name: quantum-governance
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: '9090'
        prometheus.io/scrape: 'true'
      labels:
        app.kubernetes.io/component: service
        app.kubernetes.io/name: quantum-governance
        app.kubernetes.io/version: v4.0.0-quantum
        eco-base/governance: aligned
        eco-base/part-of: eco-base
    spec:
      containers:
      - env:
        - name: QUANTUM_BACKEND
          value: ibm_quantum_falcon
        - name: COHERENCE_THRESHOLD
          value: '0.9999'
        - name: ENTANGLEMENT_DEPTH
          value: '7'
        - name: QUANTUM_API_TOKEN
          valueFrom:
            secretKeyRef:
              key: quantum-api-token
              name: quantum-governance-secrets
        - name: QUANTUM_SIGNATURE_KEY
          valueFrom:
            secretKeyRef:
              key: quantum-signature-key
              name: quantum-governance-secrets
        image: machinenativeops/quantum-governance:v4.0.0
        imagePullPolicy: Always
        livenessProbe:
          failureThreshold: 3
          httpGet:
            path: /health
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 5
        name: quantum-governance
        ports:
        - containerPort: 8080
          name: http
          protocol: TCP
        - containerPort: 9090
          name: metrics
          protocol: TCP
        - containerPort: 16686
          name: jaeger
          protocol: TCP
        readinessProbe:
          failureThreshold: 3
          httpGet:
            path: /ready
            port: 8080
          initialDelaySeconds: 5
          periodSeconds: 5
          timeoutSeconds: 3
        resources:
          limits:
            cpu: 4vQuantum
            ephemeral-storage: 20Gi
            memory: 8GiQuantum
          requests:
            cpu: 2vQuantum
            ephemeral-storage: 10Gi
            memory: 4GiQuantum
        volumeMounts:
        - mountPath: /etc/quantum-governance
          name: config-volume
          readOnly: true
        - mountPath: /etc/policies
          name: policies-volume
          readOnly: true
      serviceAccountName: quantum-governance-sa
      volumes:
      - configMap:
          items:
          - key: quantum-config.yaml
            path: quantum-config.yaml
          name: quantum-governance-config
        name: config-volume
      - configMap:
          items:
          - key: naming-policies.yaml
            path: naming-policies.yaml
          name: quantum-governance-config
        name: policies-volume
---
apiVersion: v1
kind: Service
metadata:
  annotations:
    eco-base/audit-log-level: minimal
    eco-base/governance-policy: standard-v1
    eco-base/uri: eco-base://k8s/core/service/quantum-governance-service
    eco-base/urn: urn:eco-base:k8s:core:service:quantum-governance-service:sha256-28ef5c9510835e8c6fb4fbb4ca00253946d57500ed860c42e74491862135279a
    prometheus.io/port: '9090'
    prometheus.io/scrape: 'true'
  labels:
    app.kubernetes.io/component: service
    app.kubernetes.io/instance: eco-instance
    app.kubernetes.io/name: quantum-governance
    app.kubernetes.io/part-of: eco-base
    app.kubernetes.io/version: 1.0.0
    eco-base/environment: development
    eco-base/governance: aligned
    eco-base/owner: eco-system
    eco-base/part-of: eco-base
    eco-base/platform: core
  name: quantum-governance-service
  namespace: quantum-governance
spec:
  ports:
  - name: http
    port: 80
    protocol: TCP
    targetPort: 8080
  - name: metrics
    port: 9090
    protocol: TCP
    targetPort: 9090
  - name: jaeger
    port: 16686
    protocol: TCP
    targetPort: 16686
  selector:
    app.kubernetes.io/component: service
    app.kubernetes.io/name: quantum-governance
  type: LoadBalancer
---
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  behavior:
    scaleDown:
      policies:
      - periodSeconds: 60
        type: Percent
        value: 10
      selectPolicy: Min
      stabilizationWindowSeconds: 300
    scaleUp:
      policies:
      - periodSeconds: 15
        type: Percent
        value: 100
      - periodSeconds: 15
        type: Pods
        value: 4
      selectPolicy: Max
      stabilizationWindowSeconds: 60
  maxReplicas: 10
  metrics:
  - resource:
      name: cpu
      target:
        averageUtilization: 70
        type: Utilization
    type: Resource
  - resource:
      name: memory
      target:
        averageUtilization: 80
        type: Utilization
    type: Resource
  - pods:
      metric:
        name: quantum_coherence
      target:
        averageValue: '0.999'
        type: AverageValue
    type: Pods
  minReplicas: 3
  name: quantum-governance-service
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
---
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  labels:
    app.kubernetes.io/component: monitoring
    app.kubernetes.io/name: quantum-governance
    eco-base/governance: aligned
    eco-base/part-of: eco-base
    release: prometheus
  name: quantum-governance-monitor
  namespace: quantum-governance
spec:
  endpoints:
  - honorLabels: true
    interval: 15s
    metricRelabelings:
    - regex: quantum_(.+)
      replacement: quantum_$1
      sourceLabels:
      - __name__
      targetLabel: __name__
    path: /metrics
    port: metrics
  selector:
    matchLabels:
      app.kubernetes.io/component: service
      app.kubernetes.io/name: quantum-governance
---
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  labels:
    app.kubernetes.io/component: monitoring
    app.kubernetes.io/name: quantum-governance
    eco-base/governance: aligned
    eco-base/part-of: eco-base
    release: prometheus
  name: quantum-governance-rules
  namespace: quantum-governance
spec:
  groups:
  - name: quantum-naming-governance
    rules:
    - alert: QuantumCoherenceLow
      annotations:
        description: Quantum coherence {{ $value }} below 0.999
        summary: Quantum coherence below threshold
      expr: quantum_coherence < 0.999
      for: 2m
      labels:
        eco-base/governance: aligned
        eco-base/part-of: eco-base
        severity: critical
    - alert: QuantumEntanglementWeak
      annotations:
        description: Entanglement strength {{ $value }} below 0.95
        summary: Quantum entanglement weak
      expr: quantum_entanglement_strength < 0.95
      for: 3m
      labels:
        eco-base/governance: aligned
        eco-base/part-of: eco-base
        severity: warning
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  labels:
    app.kubernetes.io/component: network
    app.kubernetes.io/name: quantum-governance
    eco-base/governance: aligned
    eco-base/part-of: eco-base
  name: quantum-governance-netpol
  namespace: quantum-governance
spec:
  egress:
  - ports:
    - port: 443
      protocol: TCP
    - port: 53
      protocol: TCP
    - port: 53
      protocol: UDP
    to:
    - namespaceSelector: {}
  - ports:
    - port: 9090
      protocol: TCP
    to:
    - podSelector:
        matchLabels:
          app.kubernetes.io/name: prometheus
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          name: monitoring
    - namespaceSelector:
        matchLabels:
          name: ingress-nginx
    ports:
    - port: 8080
      protocol: TCP
    - port: 9090
      protocol: TCP
  podSelector:
    matchLabels:
      app.kubernetes.io/name: quantum-governance
  policyTypes:
  - Ingress
  - Egress
---
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  labels:
    app.kubernetes.io/component: availability
    app.kubernetes.io/name: quantum-governance
    eco-base/governance: aligned
    eco-base/part-of: eco-base
  name: quantum-governance-pdb
  namespace: quantum-governance
spec:
  minAvailable: 2
  selector:
    matchLabels:
      app.kubernetes.io/component: service
      app.kubernetes.io/name: quantum-governance
---
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  labels:
    app.kubernetes.io/component: certificate
    app.kubernetes.io/name: quantum-governance
    eco-base/governance: aligned
    eco-base/part-of: eco-base
  name: quantum-governance-tls
  namespace: quantum-governance
spec:
  dnsNames:
  - gov.quantum.machinenativeops.io
  issuerRef:
    kind: ClusterIssuer
    name: letsencrypt-prod
  secretName: quantum-governance-tls
  secretTemplate:
    annotations:
      kubernetes.io/tls-acme: 'true'
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
    eco-base/audit-log-level: minimal
    eco-base/governance-policy: standard-v1
    eco-base/uri: eco-base://k8s/core/ingress/quantum-governance-ingress
    eco-base/urn: urn:eco-base:k8s:core:ingress:quantum-governance-ingress:sha256-49022b8e13af0eb72708bd51aa7c3a617ada63d8187f0f05e86d2dfabc4ad254
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/proxy-body-size: 10m
    nginx.ingress.kubernetes.io/ssl-redirect: 'true'
    prometheus.io/port: '9090'
    prometheus.io/scrape: 'true'
  labels:
    app.kubernetes.io/component: ingress
    app.kubernetes.io/instance: eco-instance
    app.kubernetes.io/name: quantum-governance
    app.kubernetes.io/part-of: eco-base
    app.kubernetes.io/version: 1.0.0
    eco-base/environment: development
    eco-base/governance: aligned
    eco-base/owner: eco-system
    eco-base/part-of: eco-base
    eco-base/platform: core
  name: quantum-governance-ingress
  namespace: quantum-governance
spec:
  rules:
  - host: gov.quantum.machinenativeops.io
    http:
      paths:
      - backend:
          service:
            name: quantum-governance-service
            port:
              number: 8080
        path: /api/v4/validate
        pathType: Prefix
      - backend:
          service:
            name: quantum-governance-service
            port:
              number: 8080
        path: /api/v4/repair
        pathType: Prefix
      - backend:
          service:
            name: quantum-governance-service
            port:
              number: 9090
        path: /metrics
        pathType: Prefix
  tls:
  - hosts:
    - gov.quantum.machinenativeops.io
    secretName: quantum-governance-tls
