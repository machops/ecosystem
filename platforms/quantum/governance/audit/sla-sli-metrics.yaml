# @ECO-layer: GQS-L0
# @ECO-governed
# @ECO-layer: GL90-99
# @ECO-semantic: governance-core
# @ECO-audit-trail: gov-enterprise-architecture/governance/audit-trails/GL90_99-audit.json
#
# GL Unified Architecture Governance Framework Activated
# GL Root Semantic Anchor: gov-enterprise-architecture/governance/ECO-ROOT-SEMANTIC-ANCHOR.yaml
# GL Unified Naming Charter: gov-enterprise-architecture/governance/ECO-UNIFIED-NAMING-CHARTER.yaml


apiVersion: metrics.machinenativeops.io/v1
kind: SLASLIMetrics
metadata:
  name: gov-quantum-sla-sli
  namespace: governance
  labels:
    eco-base/part-of: eco-base
    eco-base/governance: aligned
    gov-version: v10.0.0
    tier: quantum-audit
spec:
  enabled: true
  
  SLIs:
    - name: pipeline-success-rate
      description: "Percentage of successful pipeline runs"
      query: |
        sum(rate(pipeline_runs_total{status="success"}[1h])) / 
        sum(rate(pipeline_runs_total[1h]))
      target: 0.95
      window: 1h
      
    - name: naming-compliance-rate
      description: "Percentage of resources compliant with naming policy"
      query: |
        (sum(kube_pod_info) - sum(increase(glnamingconvention_violations_total[1h]))) / 
        sum(kube_pod_info)
      target: 0.95
      window: 1h
      
    - name: security-scan-coverage
      description: "Percentage of resources scanned for security vulnerabilities"
      query: |
        count(count_over_time(trivy_scans_total[1h])) / 
        count(kube_pod_info)
      target: 0.99
      window: 24h
      
    - name: deployment-success-rate
      description: "Percentage of successful deployments"
      query: |
        sum(rate(deployments_total{status="success"}[1h])) / 
        sum(rate(deployments_total[1h]))
      target: 0.98
      window: 1h
      
    - name: incident-response-time
      description: "Average time to respond to incidents"
      query: |
        avg(incident_response_time_seconds) by (severity)
      target:
        critical: 300
        high: 900
        medium: 1800
      window: 24h
      
  SLAs:
    - name: availability-sla
      description: "Platform availability"
      objective: 99.9%
      measurementPeriod: 30d
      penalty:
        below99.9: none
        below99.5: credit
        below99: escalation
        
    - name: deployment-sla
      description: "Deployment success rate"
      objective: 98%
      measurementPeriod: 7d
      penalty:
        below98: review
        below95: pause
        
    - name: response-sla
      description: "Incident response time"
      objective:
        critical: 5m
        high: 15m
        medium: 30m
      measurementPeriod: 24h
      penalty:
        exceeded: review
      
  alerts:
    - name: sli-below-target
      condition: sli_value < target * 0.9
      severity: warning
      duration: 15m
      
    - name: sli-critical
      condition: sli_value < target * 0.8
      severity: critical
      duration: 5m
      
    - name: sla-breached
      condition: sla_breached
      severity: critical
      duration: 1m
      
  dashboards:
    - name: sla-sli-overview
      panels:
        - title: "SLI Overview"
          metrics:
            - pipeline-success-rate
            - naming-compliance-rate
            - security-scan-coverage
            - deployment-success-rate
            
        - title: "SLA Compliance"
          metrics:
            - availability-sla
            - deployment-sla
            - response-sla
            
        - title: "Trend Analysis"
          metrics:
            - historical-sli-values
            - trend-lines
            
  reporting:
    enabled: true
    schedules:
      - name: daily-report
        cron: "0 0 * * *"
        recipients: ["platform-team@machinenativeops.com"]
        
      - name: sla-breach-alert
        condition: sla_breached
        recipients: ["management@machinenativeops.com", "platform-team@machinenativeops.com"]
        
  PDCA:
    plan:
      - analyze-sli-trends
      - identify-improvement-opportunities
      - set-improvement-targets
      
    do:
      - implement-improvements
      - monitor-changes
      - collect-data
      
    check:
      - measure-sli-impact
      - compare-with-targets
      - validate-improvements
      
    act:
      - standardize-improvements
      - update-targets
      - share-learnings
      
    cycle:
      frequency: monthly
      review-meeting: true
      stakeholders:
        - platform-team
        - governance-team
        - security-team