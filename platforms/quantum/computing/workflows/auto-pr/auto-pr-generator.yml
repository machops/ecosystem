# @GL-layer: GQS-L0
# @GL-governed
# @GL-layer: GL00-09
# @GL-semantic: general-component
# @GL-audit-trail: gl-enterprise-architecture/governance/audit-trails/GL00_09-audit.json
#
# GL Unified Architecture Governance Framework Activated
# GL Root Semantic Anchor: gl-enterprise-architecture/governance/GL-ROOT-SEMANTIC-ANCHOR.yaml
# GL Unified Naming Charter: gl-enterprise-architecture/governance/GL-UNIFIED-NAMING-CHARTER.yaml


apiVersion: autopullrequest.machinenativeops.io/v1
kind: AutoPRGenerator
metadata:
  name: gl-quantum-auto-pr-generator
  namespace: github-actions
  labels:
    gl-version: v10.0.0
    tier: quantum-autopr
spec:
  enabled: true
  mode: automatic
  
  prGeneration:
    triggerOn:
      - repair-completed
      - security-issue-detected
      - compliance-violation-detected
      
    conditions:
      - name: minimum-severity
        threshold: medium
        
      - name: requires-approval
        forSecurityIssues: true
        
      - name: max-prs-per-day
        limit: 10
        
  prTemplate:
    title: "[GL-Auto] ${repairType} - ${issueSummary}"
    body: |
      ## GL Quantum Auto-Generated Pull Request
      
      This PR was automatically generated by the GL Quantum Architecture Platform.
      
      ### Issue Detected
      - **Type**: ${issueType}
      - **Severity**: ${severity}
      - **Detected At**: ${timestamp}
      
      ### Repair Applied
      - **Strategy**: ${repairStrategy}
      - **Changes**: ${changeSummary}
      
      ### Validation
      - ✅ Syntax Validated
      - ✅ Schema Compliant
      - ✅ Lint Passed
      - ✅ Dry-Run Success
      
      ### Risk Assessment
      - **Risk Level**: ${riskLevel}
      - **Impact**: ${impact}
      - **Rollback Available**: Yes
      
      ### Approval
      ${approvalBlock}
      
    labels:
      - gl-auto-generated
      - gl-quantum-repair
      - severity-${severity}
      
    assignees:
      - platform-team
      
    reviewers:
      required: 2
      teams:
        - platform-reviewers
        
  signing:
    enabled: true
    method: pgp
    keyId: ${{ secrets.GL_PGP_KEY_ID }}
    passphrase: ${{ secrets.GL_PGP_PASSPHRASE }}
    
  verification:
    preMerge:
      - type: ci-checks
        required: true
        
      - type: security-scan
        required: true
        
      - type: governance-validation
        required: true
        
    postMerge:
      - type: deployment-verification
        required: true
        
      - type: monitoring-check
        required: true
        
  merge:
    strategy: squash-merge
    deleteBranch: true
    autoMerge:
      enabled: false
      requireApproval: true
      
  audit:
    logPath: artifacts/audit/auto-pr-audit.log
    retention: 365d