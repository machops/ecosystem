---
apiVersion: v1
data:
  resilience-policies.yaml: "version: \"1.0\"\n\n# Retry Policies\nretry_policies:\n\
    \  default:\n    enabled: true\n    max_attempts: 3\n    initial_interval: 1000ms\n\
    \    max_interval: 10000ms\n    multiplier: 2.0\n    randomization_factor: 0.1\n\
    \    \n  api_requests:\n    enabled: true\n    max_attempts: 3\n    initial_interval:\
    \ 500ms\n    max_interval: 5000ms\n    multiplier: 2.0\n    retryable_status_codes:\
    \ [408, 429, 500, 502, 503, 504]\n    backoff_strategy: \"exponential\"\n    \n\
    \  database_queries:\n    enabled: true\n    max_attempts: 2\n    initial_interval:\
    \ 100ms\n    max_interval: 1000ms\n    multiplier: 1.5\n    retryable_exceptions:\n\
    \      - \"ConnectionTimeout\"\n      - \"OperationTimeout\"\n      - \"TransientError\"\
    \n    \n  cache_operations:\n    enabled: true\n    max_attempts: 2\n    initial_interval:\
    \ 50ms\n    max_interval: 500ms\n    multiplier: 1.5\n    retryable_exceptions:\n\
    \      - \"CacheMiss\"\n      - \"Timeout\"\n    \n  external_api_calls:\n   \
    \ enabled: true\n    max_attempts: 5\n    initial_interval: 1000ms\n    max_interval:\
    \ 30000ms\n    multiplier: 2.0\n    retryable_status_codes: [408, 429, 500, 502,\
    \ 503, 504]\n    backoff_strategy: \"exponential_with_jitter\"\n\n# Circuit Breakers\n\
    circuit_breakers:\n  default:\n    enabled: true\n    failure_threshold: 5\n \
    \   success_threshold: 2\n    timeout: 60000ms\n    reset_timeout: 300000ms\n\
    \    half_open_max_calls: 3\n    monitoring_period: 10000ms\n    \n  api_service:\n\
    \    enabled: true\n    failure_threshold: 10\n    success_threshold: 3\n    timeout:\
    \ 30000ms\n    reset_timeout: 120000ms\n    half_open_max_calls: 5\n    monitoring_period:\
    \ 60000ms\n    \n  database_service:\n    enabled: true\n    failure_threshold:\
    \ 5\n    success_threshold: 2\n    timeout: 5000ms\n    reset_timeout: 60000ms\n\
    \    half_open_max_calls: 3\n    monitoring_period: 10000ms\n    \n  cache_service:\n\
    \    enabled: true\n    failure_threshold: 15\n    success_threshold: 5\n    timeout:\
    \ 1000ms\n    reset_timeout: 30000ms\n    half_open_max_calls: 10\n    monitoring_period:\
    \ 5000ms\n    \n  external_service_a:\n    enabled: true\n    failure_threshold:\
    \ 3\n    success_threshold: 1\n    timeout: 10000ms\n    reset_timeout: 180000ms\n\
    \    half_open_max_calls: 2\n    monitoring_period: 30000ms\n\n# Rate Limiting\n\
    rate_limiting:\n  enabled: true\n  default_policy:\n    enabled: true\n    requests_per_second:\
    \ 100\n    burst: 200\n    algorithm: \"token_bucket\"\n    \n  api_endpoints:\n\
    \    /health:\n      requests_per_second: 1000\n      burst: 2000\n      algorithm:\
    \ \"leaky_bucket\"\n    \n    /api/v1/data:\n      requests_per_second: 100\n\
    \      burst: 200\n      algorithm: \"token_bucket\"\n    \n    /api/v1/metrics:\n\
    \      requests_per_second: 50\n      burst: 100\n      algorithm: \"token_bucket\"\
    \n    \n    /api/v1/admin:\n      requests_per_second: 10\n      burst: 20\n \
    \     algorithm: \"sliding_window\"\n      window_size: 60s\n    \n  user_based:\n\
    \    enabled: true\n    default_limit: 100\n    default_burst: 200\n    tier_limits:\n\
    \      free:\n        requests_per_second: 10\n        burst: 20\n      standard:\n\
    \        requests_per_second: 50\n        burst: 100\n      premium:\n       \
    \ requests_per_second: 200\n        burst: 400\n  \n  ip_based:\n    enabled:\
    \ true\n    default_limit: 100\n    default_burst: 200\n    whitelist:\n     \
    \ - \"10.0.0.0/8\"\n      - \"172.16.0.0/12\"\n      - \"192.168.0.0/16\"\n  \
    \  blacklist:\n      - \"192.0.2.0/24\"\n      - \"198.51.100.0/24\"\n\n# Request\
    \ Queuing\nrequest_queuing:\n  enabled: true\n  default_queue:\n    max_size:\
    \ 1000\n    max_wait_time: 30000ms\n    timeout: 60000ms\n    \n  api_queue:\n\
    \    max_size: 5000\n    max_wait_time: 60000ms\n    timeout: 120000ms\n    priority_levels:\
    \ 3\n    \n  background_tasks:\n    max_size: 10000\n    max_wait_time: 300000ms\n\
    \    timeout: 600000ms\n    priority_levels: 5\n    \n  queue_strategy: \"priority\"\
    \n  rejection_policy: \"oldest\"\n\n# Throttling\nthrottling:\n  enabled: true\n\
    \  adaptive:\n    enabled: true\n    metrics:\n      - cpu_usage\n      - memory_usage\n\
    \      - request_latency\n      - error_rate\n    \n    thresholds:\n      cpu_usage:\n\
    \        warning: 0.70\n        critical: 0.85\n        action: \"reduce_rate\"\
    \n      \n      memory_usage:\n        warning: 0.80\n        critical: 0.90\n\
    \        action: \"reduce_rate\"\n      \n      request_latency:\n        warning:\
    \ 300ms\n        critical: 500ms\n        action: \"reduce_rate\"\n      \n  \
    \    error_rate:\n        warning: 0.02\n        critical: 0.05\n        action:\
    \ \"reduce_rate\"\n    \n    actions:\n      reduce_rate:\n        factor: 0.5\n\
    \        min_requests_per_second: 10\n      reject_new:\n        message: \"Service\
    \ under heavy load, please try again later\"\n      enable_degraded_mode:\n  \
    \      enabled: true\n        timeout: 60000ms\n\n# Graceful Degradation\ngraceful_degradation:\n\
    \  enabled: true\n  levels:\n    normal:\n      features:\n        - \"full_api\"\
    \n        - \"real_time_updates\"\n        - \"advanced_analytics\"\n        -\
    \ \"background_processing\"\n    \n    degraded:\n      trigger_conditions:\n\
    \        - cpu_usage > 0.80\n        - memory_usage > 0.85\n        - error_rate\
    \ > 0.05\n      features:\n        - \"basic_api\"\n        - \"cached_responses\"\
    \n        - \"essential_analytics\"\n      disabled_features:\n        - \"real_time_updates\"\
    \n        - \"background_processing\"\n    \n    critical:\n      trigger_conditions:\n\
    \        cpu_usage > 0.90\n        memory_usage > 0.95\n        error_rate > 0.10\n\
    \      features:\n        - \"read_only_api\"\n        - \"cached_responses\"\n\
    \      disabled_features:\n        - \"write_operations\"\n        - \"advanced_analytics\"\
    \n        - \"real_time_updates\"\n        - \"background_processing\"\n    \n\
    \    emergency:\n      trigger_conditions:\n        system_failure: true\n   \
    \   features:\n        - \"maintenance_page\"\n      disabled_features:\n    \
    \    - \"api_access\"\n        - \"write_operations\"\n        - \"read_operations\"\
    \n    \n  auto_degradation: true\n  manual_override: true\n  notification: true\n\
    \n# Fallback Mechanisms\nfallback_mechanisms:\n  cache_fallback:\n    enabled:\
    \ true\n    primary: \"redis_cluster\"\n    fallback: \"local_cache\"\n    fallback_to_default:\
    \ true\n    default_ttl: 300s\n    \n  database_fallback:\n    enabled: true\n\
    \    primary: \"postgres_primary\"\n    fallback: \"postgres_replica\"\n    fallback_to_cache:\
    \ true\n    read_only_mode: true\n    \n  api_fallback:\n    enabled: true\n \
    \   primary: \"main_api\"\n    fallback: \"cached_api\"\n    fallback_to_default_response:\
    \ true\n    default_response_timeout: 1000ms\n    \n  service_discovery_fallback:\n\
    \    enabled: true\n    primary: \"kubernetes_dns\"\n    fallback: \"static_endpoints\"\
    \n    fallback_to_hardcoded: true\n    \n  configuration_fallback:\n    enabled:\
    \ true\n    primary: \"config_server\"\n    fallback: \"local_config\"\n    fallback_to_defaults:\
    \ true\n\n# Bulkhead Pattern\nbulkhead:\n  enabled: true\n  policies:\n    api_operations:\n\
    \      max_concurrent_calls: 100\n      max_wait_time: 5000ms\n      timeout:\
    \ 30000ms\n    \n    database_operations:\n      max_concurrent_calls: 50\n  \
    \    max_wait_time: 10000ms\n      timeout: 30000ms\n    \n    cache_operations:\n\
    \      max_concurrent_calls: 200\n      max_wait_time: 1000ms\n      timeout:\
    \ 5000ms\n    \n    external_api_calls:\n      max_concurrent_calls: 20\n    \
    \  max_wait_time: 30000ms\n      timeout: 60000ms\n  \n  queue_full_policy: \"\
    reject\"\n  rejection_message: \"Service is busy, please try again later\""
kind: ConfigMap
metadata:
  annotations:
    eco-base/audit-log-level: minimal
    eco-base/governance-policy: standard-v1
    eco-base/uri: eco-base://k8s/core/configmap/resilience-policies
    eco-base/urn: urn:eco-base:k8s:core:configmap:resilience-policies:sha256-478f5c9a4f8070689063123316f6fa4a2a08de46338738d028559841c4e6252d
  labels:
    app.kubernetes.io/component: eco-component
    app.kubernetes.io/instance: eco-instance
    app.kubernetes.io/name: resilience
    app.kubernetes.io/part-of: eco-base
    app.kubernetes.io/version: 1.0.0
    eco-base/environment: development
    eco-base/governance: aligned
    eco-base/owner: eco-system
    eco-base/part-of: eco-base
    eco-base/platform: core
    environment: production
  name: resilience-policies
  namespace: production
