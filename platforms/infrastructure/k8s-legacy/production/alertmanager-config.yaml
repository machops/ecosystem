---
apiVersion: v1
data:
  alertmanager.yml: "global:\n  resolve_timeout: 5m\n  slack_api_url: '${SLACK_WEBHOOK_URL}'\n\
    \  pagerduty_url: '${PAGERDUTY_URL}'\n\ntemplates:\n- '/etc/alertmanager/templates/*.tmpl'\n\
    \nroute:\n  group_by: ['alertname', 'cluster', 'service']\n  group_wait: 30s\n\
    \  group_interval: 5m\n  repeat_interval: 4h\n  receiver: 'default'\n  routes:\n\
    \  - match:\n      severity: critical\n    receiver: 'critical-alerts'\n    continue:\
    \ true\n  - match:\n      severity: warning\n    receiver: 'warning-alerts'\n\
    \  - match:\n      service: machine-native-ops\n    receiver: 'machine-native-ops-alerts'\n\
    \nreceivers:\n- name: 'default'\n  slack_configs:\n  - channel: '#alerts'\n  \
    \  send_resolved: true\n    title: '[{{ .Status | toUpper }}] {{ .GroupLabels.alertname\
    \ }}'\n    text: >-\n      {{ range .Alerts }}\n      *Alert:* {{ .Labels.alertname\
    \ }}\n      *Severity:* {{ .Labels.severity }}\n      *Description:* {{ .Annotations.description\
    \ }}\n      *Details:*\n      {{ range .Labels.SortedPairs }} • *{{ .Name }}:*\
    \ {{ .Value }}\n      {{ end }}\n      {{ end }}\n\n- name: 'critical-alerts'\n\
    \  slack_configs:\n  - channel: '#critical-alerts'\n    send_resolved: true\n\
    \    title: '[CRITICAL] {{ .GroupLabels.alertname }}'\n    text: >-\n      {{\
    \ range .Alerts }}\n      *Alert:* {{ .Labels.alertname }}\n      *Severity:*\
    \ {{ .Labels.severity }}\n      *Description:* {{ .Annotations.description }}\n\
    \      *Details:*\n      {{ range .Labels.SortedPairs }} • *{{ .Name }}:* {{ .Value\
    \ }}\n      {{ end }}\n      {{ end }}\n  pagerduty_configs:\n  - service_key:\
    \ '${PAGERDUTY_SERVICE_KEY}'\n    description: '{{ .GroupLabels.alertname }}'\n\
    \n- name: 'warning-alerts'\n  slack_configs:\n  - channel: '#alerts'\n    send_resolved:\
    \ true\n    title: '[WARNING] {{ .GroupLabels.alertname }}'\n    text: >-\n  \
    \    {{ range .Alerts }}\n      *Alert:* {{ .Labels.alertname }}\n      *Severity:*\
    \ {{ .Labels.severity }}\n      *Description:* {{ .Annotations.description }}\n\
    \      {{ end }}\n\n- name: 'machine-native-ops-alerts'\n  slack_configs:\n  -\
    \ channel: '#machine-native-ops'\n    send_resolved: true\n    title: '[Machine\
    \ Native Ops] {{ .GroupLabels.alertname }}'\n    text: >-\n      {{ range .Alerts\
    \ }}\n      *Alert:* {{ .Labels.alertname }}\n      *Severity:* {{ .Labels.severity\
    \ }}\n      *Description:* {{ .Annotations.description }}\n      *Service:* {{\
    \ .Labels.service }}\n      *Instance:* {{ .Labels.instance }}\n      {{ end }}\n\
    \  email_configs:\n  - to: 'ops@machinenativeops.com'\n    headers:\n      Subject:\
    \ '[Machine Native Ops Alert] {{ .GroupLabels.alertname }}'\n    html: >-\n  \
    \    {{ range .Alerts }}\n      <h3>{{ .Labels.alertname }}</h3>\n      <p><strong>Severity:</strong>\
    \ {{ .Labels.severity }}</p>\n      <p><strong>Description:</strong> {{ .Annotations.description\
    \ }}</p>\n      <p><strong>Service:</strong> {{ .Labels.service }}</p>\n     \
    \ <p><strong>Instance:</strong> {{ .Labels.instance }}</p>\n      {{ end }}\n\n\
    inhibit_rules:\n- source_match:\n    severity: 'critical'\n  target_match:\n \
    \   severity: 'warning'\n  equal: ['alertname', 'cluster', 'service']"
kind: ConfigMap
metadata:
  annotations:
    eco-base/audit-log-level: minimal
    eco-base/governance-policy: standard-v1
    eco-base/uri: eco-base://k8s/core/configmap/alertmanager-config
    eco-base/urn: urn:eco-base:k8s:core:configmap:alertmanager-config:sha256-71fdedfa84c25e9d13053627f6112da2832f9d8b9005283a2f0e616bb78a6661
  labels:
    app.kubernetes.io/component: eco-component
    app.kubernetes.io/instance: eco-instance
    app.kubernetes.io/name: alertmanager
    app.kubernetes.io/part-of: eco-base
    app.kubernetes.io/version: 1.0.0
    eco-base/environment: development
    eco-base/governance: aligned
    eco-base/owner: eco-system
    eco-base/part-of: eco-base
    eco-base/platform: core
    environment: production
  name: alertmanager-config
  namespace: monitoring
