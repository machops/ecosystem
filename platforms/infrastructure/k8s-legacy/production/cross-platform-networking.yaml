---
apiVersion: v1
data:
  load-balancing.yaml: "loadBalancing:\n  # AWS Load Balancer\n  aws:\n    applicationLoadBalancer:\n\
    \      enabled: ${AWS_ALB_ENABLED:-true}\n      name: ${AWS_ALB_NAME:-machine-native-ops-alb}\n\
    \      scheme: internet-facing\n      ipAddressType: ipv4\n      type: application\n\
    \      subnets: ${AWS_ALB_SUBNETS:-}\n      securityGroups: ${AWS_ALB_SECURITY_GROUPS:-}\n\
    \      listeners:\n        - port: 80\n          protocol: HTTP\n          defaultActions:\n\
    \            - type: forward\n              targetGroup: ${TARGET_GROUP_ARN}\n\
    \        - port: 443\n          protocol: HTTPS\n          certificates:\n   \
    \         - certificateArn: ${SSL_CERTIFICATE_ARN}\n          defaultActions:\n\
    \            - type: forward\n              targetGroup: ${TARGET_GROUP_ARN}\n\
    \      targetGroups:\n        - name: machine-native-ops-tg\n          port: 8080\n\
    \          protocol: HTTP\n          healthCheck:\n            path: /health\n\
    \            interval: 30\n            timeout: 5\n            healthyThreshold:\
    \ 3\n            unhealthyThreshold: 3\n            matcher:\n              httpCode:\
    \ 200\n    \n    networkLoadBalancer:\n      enabled: ${AWS_NLB_ENABLED:-false}\n\
    \      name: ${AWS_NLB_NAME:-machine-native-ops-nlb}\n      scheme: internet-facing\n\
    \      type: network\n      crossZoneLoadBalancing: true\n      listeners:\n \
    \       - port: 8080\n          protocol: TCP\n  \n  # Google Cloud Load Balancing\n\
    \  gcp:\n    globalLoadBalancer:\n      enabled: ${GCP_LB_ENABLED:-true}\n   \
    \   name: ${GCP_LB_NAME:-machine-native-ops-lb}\n      ipAddress: ${GCP_LB_IP:-}\n\
    \      ports:\n        - port: 80\n          protocol: HTTP\n        - port: 443\n\
    \          protocol: HTTPS\n          sslCertificates:\n            - ${GCP_SSL_CERTIFICATE:-}\n\
    \      backendServices:\n        - name: machine-native-ops-backend\n        \
    \  protocol: HTTP\n          portName: http\n          healthCheck:\n        \
    \    checkIntervalSec: 30\n            timeoutSec: 5\n            healthyThreshold:\
    \ 3\n            unhealthyThreshold: 3\n            httpHealthCheck:\n       \
    \       port: 8080\n              requestPath: /health\n      urlMaps:\n     \
    \   - name: machine-native-ops-urlmap\n          defaultService: machine-native-ops-backend\n\
    \  \n  # Azure Load Balancing\n  azure:\n    loadBalancer:\n      enabled: ${AZURE_LB_ENABLED:-true}\n\
    \      name: ${AZURE_LB_NAME:-machine-native-ops-lb}\n      sku: Standard\n  \
    \    frontendIPConfigurations:\n        - name: frontend\n          publicIPAddress:\
    \ ${AZURE_PUBLIC_IP:-}\n      probes:\n        - name: health-probe\n        \
    \  protocol: Http\n          port: 8080\n          requestPath: /health\n    \
    \      intervalInSeconds: 30\n          numberOfProbes: 3\n      loadBalancingRules:\n\
    \        - name: http-rule\n          frontendPort: 80\n          backendPort:\
    \ 8080\n          protocol: Tcp\n          probe: health-probe\n        - name:\
    \ https-rule\n          frontendPort: 443\n          backendPort: 8080\n     \
    \     protocol: Tcp\n          probe: health-probe"
  network-topology.yaml: "networkTopology:\n  provider: ${NETWORK_PROVIDER:-aws} \
    \ # aws | gcp | azure | on-prem\n  \n  # AWS VPC Configuration\n  aws:\n    vpc:\n\
    \      cidr: ${VPC_CIDR:-10.0.0.0/16}\n      enableDnsSupport: true\n      enableDnsHostnames:\
    \ true\n      instanceTenancy: default\n    \n    subnets:\n      public:\n  \
    \      - cidr: ${PUBLIC_SUBNET_1:-10.0.1.0/24}\n          az: ${ZONE_1:-us-east-1a}\n\
    \          mapPublicIpOnLaunch: true\n        - cidr: ${PUBLIC_SUBNET_2:-10.0.2.0/24}\n\
    \          az: ${ZONE_2:-us-east-1b}\n          mapPublicIpOnLaunch: true\n  \
    \      - cidr: ${PUBLIC_SUBNET_3:-10.0.3.0/24}\n          az: ${ZONE_3:-us-east-1c}\n\
    \          mapPublicIpOnLaunch: true\n      \n      private:\n        - cidr:\
    \ ${PRIVATE_SUBNET_1:-10.0.11.0/24}\n          az: ${ZONE_1:-us-east-1a}\n   \
    \       mapPublicIpOnLaunch: false\n        - cidr: ${PRIVATE_SUBNET_2:-10.0.12.0/24}\n\
    \          az: ${ZONE_2:-us-east-1b}\n          mapPublicIpOnLaunch: false\n \
    \       - cidr: ${PRIVATE_SUBNET_3:-10.0.13.0/24}\n          az: ${ZONE_3:-us-east-1c}\n\
    \          mapPublicIpOnLaunch: false\n      \n      database:\n        - cidr:\
    \ ${DATABASE_SUBNET_1:-10.0.21.0/24}\n          az: ${ZONE_1:-us-east-1a}\n  \
    \        mapPublicIpOnLaunch: false\n        - cidr: ${DATABASE_SUBNET_2:-10.0.22.0/24}\n\
    \          az: ${ZONE_2:-us-east-1b}\n          mapPublicIpOnLaunch: false\n \
    \       - cidr: ${DATABASE_SUBNET_3:-10.0.23.0/24}\n          az: ${ZONE_3:-us-east-1c}\n\
    \          mapPublicIpOnLaunch: false\n    \n    internetGateway:\n      enabled:\
    \ true\n    \n    natGateway:\n      enabled: true\n      allocationIds:\n   \
    \     - ${NAT_GATEWAY_1_EIP}\n        - ${NAT_GATEWAY_2_EIP}\n        - ${NAT_GATEWAY_3_EIP}\n\
    \    \n    routeTables:\n      public:\n        routes:\n          - destination:\
    \ 0.0.0.0/0\n            gateway: internet-gateway\n      \n      private:\n \
    \       routes:\n          - destination: 0.0.0.0/0\n            gateway: nat-gateway\n\
    \    \n    securityGroups:\n      application:\n        ingress:\n          -\
    \ port: 80\n            protocol: tcp\n            cidr: 0.0.0.0/0\n         \
    \ - port: 443\n            protocol: tcp\n            cidr: 0.0.0.0/0\n      \
    \    - port: 8080\n            protocol: tcp\n            cidr: ${VPC_CIDR:-10.0.0.0/16}\n\
    \        egress:\n          - port: all\n            protocol: all\n         \
    \   cidr: 0.0.0.0/0\n      \n      database:\n        ingress:\n          - port:\
    \ 5432\n            protocol: tcp\n            cidr: ${VPC_CIDR:-10.0.0.0/16}\n\
    \        egress:\n          - port: all\n            protocol: all\n         \
    \   cidr: 0.0.0.0/0\n  \n  # Google Cloud VPC Configuration\n  gcp:\n    network:\n\
    \      name: ${GCP_NETWORK:-machine-native-ops-network}\n      autoCreateSubnetworks:\
    \ false\n      routingMode: GLOBAL\n    \n    subnets:\n      - name: ${GCP_SUBNET_1:-machine-native-ops-subnet-1}\n\
    \        region: ${GCP_REGION_1:-us-east1}\n        cidr: ${GCP_SUBNET_1_CIDR:-10.1.0.0/24}\n\
    \        privateIpGoogleAccess: true\n        enableFlowLogs: true\n      - name:\
    \ ${GCP_SUBNET_2:-machine-native-ops-subnet-2}\n        region: ${GCP_REGION_2:-us-central1}\n\
    \        cidr: ${GCP_SUBNET_2_CIDR:-10.1.1.0/24}\n        privateIpGoogleAccess:\
    \ true\n        enableFlowLogs: true\n      - name: ${GCP_SUBNET_3:-machine-native-ops-subnet-3}\n\
    \        region: ${GCP_REGION_3:-us-west1}\n        cidr: ${GCP_SUBNET_3_CIDR:-10.1.2.0/24}\n\
    \        privateIpGoogleAccess: true\n        enableFlowLogs: true\n    \n   \
    \ router:\n      name: ${GCP_ROUTER:-machine-native-ops-router}\n      region:\
    \ ${GCP_REGION_1:-us-east1}\n      nat:\n        name: ${GCP_NAT:-machine-native-ops-nat}\n\
    \        natIpAllocateOption: AUTO_ONLY\n        sourceSubnetworkIpRangesToNat:\
    \ ALL_SUBNETWORKS_ALL_IP_RANGES\n    \n    firewallRules:\n      allow-http:\n\
    \        direction: INGRESS\n        priority: 1000\n        allow:\n        \
    \  - protocol: tcp\n            ports: [\"80\"]\n        sourceRanges: [\"0.0.0.0/0\"\
    ]\n      \n      allow-https:\n        direction: INGRESS\n        priority: 1000\n\
    \        allow:\n          - protocol: tcp\n            ports: [\"443\"]\n   \
    \     sourceRanges: [\"0.0.0.0/0\"]\n      \n      allow-app.kubernetes.io/name:\
    \ direction: INGRESS\n        priority: 1000\n        allow:\n          - protocol:\
    \ tcp\n            ports: [\"8080\", \"9090\"]\n        sourceRanges: [\"10.1.0.0/16\"\
    ]\n      \n      allow-icmp:\n        direction: INGRESS\n        priority: 1000\n\
    \        allow:\n          - protocol: icmp\n        sourceRanges: [\"10.1.0.0/16\"\
    ]\n  \n  # Azure VNet Configuration\n  azure:\n    vnet:\n      name: ${AZURE_VNET:-machine-native-ops-vnet}\n\
    \      addressSpace: ${AZURE_VNET_CIDR:-10.2.0.0/16}\n      location: ${AZURE_LOCATION:-East\
    \ US}\n    \n    subnets:\n      - name: ${AZURE_SUBNET_PUBLIC:-public-subnet}\n\
    \        addressPrefix: ${AZURE_PUBLIC_SUBNET_CIDR:-10.2.1.0/24}\n        delegations:\
    \ []\n        serviceEndpoints:\n          - service: Microsoft.Storage\n    \
    \  - name: ${AZURE_SUBNET_PRIVATE:-private-subnet}\n        addressPrefix: ${AZURE_PRIVATE_SUBNET_CIDR:-10.2.2.0/24}\n\
    \        delegations: []\n      - name: ${AZURE_SUBNET_DATABASE:-database-subnet}\n\
    \        addressPrefix: ${AZURE_DATABASE_SUBNET_CIDR:-10.2.3.0/24}\n        delegations:\n\
    \          - name: Microsoft.Sql/managedInstances\n            service: Microsoft.Sql\n\
    \            type: Microsoft.Sql/managedInstances\n    \n    networkSecurityGroups:\n\
    \      application:\n        securityRules:\n          - name: Allow-HTTP\n  \
    \          priority: 100\n            direction: Inbound\n            access:\
    \ Allow\n            protocol: Tcp\n            sourcePortRange: \"*\"\n     \
    \       destinationPortRange: \"80\"\n            sourceAddressPrefix: \"*\"\n\
    \            destinationAddressPrefix: \"*\"\n          \n          - name: Allow-HTTPS\n\
    \            priority: 110\n            direction: Inbound\n            access:\
    \ Allow\n            protocol: Tcp\n            sourcePortRange: \"*\"\n     \
    \       destinationPortRange: \"443\"\n            sourceAddressPrefix: \"*\"\n\
    \            destinationAddressPrefix: \"*\"\n          \n          - name: Allow-App\n\
    \            priority: 120\n            direction: Inbound\n            access:\
    \ Allow\n            protocol: Tcp\n            sourcePortRange: \"*\"\n     \
    \       destinationPortRange: \"8080,9090\"\n            sourceAddressPrefix:\
    \ \"10.2.0.0/16\"\n            destinationAddressPrefix: \"*\"\n"
  service-discovery.yaml: "serviceDiscovery:\n  # Kubernetes Service Discovery\n \
    \ kubernetes:\n    enabled: true\n    type: CoreDNS\n    domain: cluster.local\n\
    \    services:\n      - name: machine-native-ops\n        namespace: production\n\
    \        type: ClusterIP\n        ports:\n          - name: http\n           \
    \ port: 8080\n            targetPort: 8080\n            protocol: TCP\n      \
    \    - name: metrics\n            port: 9090\n            targetPort: 9090\n \
    \           protocol: TCP\n      - name: postgresql\n        namespace: production\n\
    \        type: ClusterIP\n        ports:\n          - name: postgresql\n     \
    \       port: 5432\n            targetPort: 5432\n            protocol: TCP\n\
    \      - name: redis\n        namespace: production\n        type: ClusterIP\n\
    \        ports:\n          - name: redis\n            port: 6379\n           \
    \ targetPort: 6379\n            protocol: TCP\n  \n  # AWS Cloud Map Service Discovery\n\
    \  aws:\n    enabled: ${AWS_CLOUDMAP_ENABLED:-false}\n    namespaceId: ${AWS_NAMESPACE_ID:-}\n\
    \    serviceId: ${AWS_SERVICE_ID:-}\n    dnsRecords:\n      - type: A\n      \
    \  ttl: 300\n      - type: SRV\n        ttl: 300\n  \n  # Google Cloud Service\
    \ Directory\n  gcp:\n    enabled: ${GCP_SERVICE_DIR_ENABLED:-false}\n    namespace:\
    \ ${GCP_NAMESPACE:-}\n    service: ${GCP_SERVICE:-}\n    region: ${GCP_REGION:-}\n\
    \  \n  # Consul Service Discovery\n  consul:\n    enabled: ${CONSUL_ENABLED:-false}\n\
    \    address: ${CONSUL_ADDR:-consul:8500}\n    token: ${CONSUL_TOKEN:-}\n    services:\n\
    \      - name: machine-native-ops\n        port: 8080\n        check:\n      \
    \    http: http://localhost:8080/health\n          interval: 10s\n          timeout:\
    \ 5s\n        tags:\n          - production\n          - v1\n"
kind: ConfigMap
metadata:
  annotations:
    eco-base/audit-log-level: minimal
    eco-base/governance-policy: standard-v1
    eco-base/uri: eco-base://k8s/core/configmap/cross-platform-networking-config
    eco-base/urn: urn:eco-base:k8s:core:configmap:cross-platform-networking-config:sha256-ebf9f5b20dda5a493fdf349583491c7e8d854ac7c75993b53a8d50af81816084
  labels:
    app.kubernetes.io/component: eco-component
    app.kubernetes.io/instance: eco-instance
    app.kubernetes.io/name: cross-platform-networking-config
    app.kubernetes.io/part-of: eco-base
    app.kubernetes.io/version: 1.0.0
    eco-base/environment: development
    eco-base/owner: eco-system
    eco-base/platform: core
  name: cross-platform-networking-config
  namespace: production
